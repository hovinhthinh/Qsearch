package eval.table.wikidata;

import util.FileUtils;
import util.SelfMonitor;

import java.io.PrintWriter;
import java.util.Arrays;
import java.util.HashSet;

public class ExtractNumericFacts {
    static HashSet<String> NUMERIC_PREDICATES = new HashSet<>(Arrays.asList(
            "P1081", "P1103", "P1108", "P1110", "P1111", "P1122", "P1193", "P1247", "P1350", "P1352", "P1356", "P1641", "P1831", "P1868", "P1873", "P2052", "P2053", "P2107", "P2117", "P2131", "P2133", "P2197", "P2200", "P2208", "P2248", "P2254", "P2257", "P2294", "P2312", "P2324", "P2403", "P2437", "P2532", "P2547", "P2555", "P2583", "P2599", "P2793", "P2855", "P2896", "P2928", "P3000", "P3039", "P3071", "P3253", "P3439", "P3737", "P4080", "P4135", "P4163", "P4184", "P4851", "P5043", "P5067", "P5575", "P5624", "P5669", "P5676", "P5681", "P5685", "P5822", "P6000", "P6274", "P6498", "P6591", "P7668", "P7725", "P7770", "P7971", "P1083", "P1088", "P1090", "P1096", "P1099", "P1120", "P1121", "P1132", "P1148", "P1174", "P1314", "P1446", "P1561", "P1661", "P1675", "P1676", "P1867", "P2043", "P2055", "P2068", "P2076", "P2097", "P2114", "P2136", "P2138", "P2142", "P2145", "P2160", "P2199", "P2201", "P2202", "P2211", "P2217", "P2295", "P2296", "P2405", "P2556", "P2635", "P2660", "P2665", "P2769", "P2781", "P2787", "P2844", "P2895", "P2923", "P3530", "P3744", "P3872", "P4036", "P4253", "P4341", "P4442", "P5044", "P5066", "P5349", "P5447", "P5480", "P5483", "P5526", "P5582", "P5608", "P5673", "P5682", "P5708", "P5811", "P5897", "P5900", "P5929", "P5991", "P5992", "P6089", "P6125", "P6260", "P6354", "P6589", "P6695", "P6897", "P7015", "P7328", "P7787", "P7863", "P8330", "P8340", "P1098", "P1126", "P1128", "P1181", "P1198", "P1339", "P1357", "P1359", "P1410", "P1457", "P1548", "P1590", "P1833", "P2054", "P2056", "P2069", "P2073", "P2077", "P2121", "P2147", "P2203", "P2223", "P2261", "P2325", "P2402", "P2595", "P2808", "P2836", "P2957", "P3387", "P3465", "P3575", "P3738", "P3917", "P4140", "P4441", "P4511", "P4841", "P5027", "P5069", "P5529", "P5596", "P5672", "P5894", "P5896", "P5898", "P5982", "P6639", "P6710", "P6826", "P6856", "P7079", "P7080", "P7083", "P7379", "P7391", "P7462", "P8093", "P8275", "P1092", "P1100", "P1107", "P1114", "P1125", "P1164", "P1215", "P1295", "P1345", "P1358", "P1539", "P1540", "P1725", "P1872", "P2021", "P2050", "P2060", "P2103", "P2109", "P2112", "P2118", "P2129", "P2144", "P2148", "P2177", "P2212", "P2214", "P2231", "P2232", "P2262", "P2292", "P2351", "P2362", "P2404", "P2436", "P2442", "P2527", "P2542", "P2565", "P2573", "P2663", "P2664", "P2717", "P2797", "P2854", "P2927", "P2955", "P3013", "P3063", "P3157", "P3252", "P3271", "P3488", "P3529", "P3840", "P3983", "P4010", "P4218", "P4269", "P4501", "P4519", "P4999", "P5045", "P5630", "P5677", "P5678", "P5679", "P5947", "P6014", "P6069", "P6073", "P6076", "P6499", "P6510", "P6544", "P6708", "P6757", "P7297", "P7527", "P8208", "P8398", "P1082", "P1093", "P1097", "P1104", "P1127", "P1139", "P1351", "P1674", "P2044", "P2048", "P2067", "P2075", "P2119", "P2134", "P2135", "P2154", "P2213", "P2221", "P2227", "P2229", "P2284", "P2300", "P2313", "P2386", "P2406", "P2415", "P2659", "P2873", "P2911", "P2929", "P3001", "P3036", "P3337", "P3395", "P3486", "P3792", "P4153", "P4250", "P4445", "P4895", "P5205", "P5428", "P5474", "P5592", "P5668", "P5670", "P5709", "P5895", "P5899", "P6249", "P6258", "P6272", "P6344", "P6509", "P6546", "P6697", "P6707", "P6753", "P8368", "P1102", "P1123", "P1279", "P1301", "P1390", "P1752", "P1971", "P2045", "P2051", "P2105", "P2113", "P2124", "P2143", "P2146", "P2149", "P2150", "P2204", "P2218", "P2219", "P2220", "P2228", "P2233", "P2234", "P2250", "P2374", "P2710", "P2712", "P2803", "P2834", "P2884", "P2997", "P3087", "P3487", "P3492", "P3891", "P3934", "P4131", "P4137", "P4176", "P4242", "P4447", "P5230", "P5281", "P5348", "P5448", "P5479", "P5481", "P5674", "P5706", "P5993", "P6261", "P6343", "P6438", "P6545", "P6570", "P6590", "P6711", "P6789", "P6794", "P6876", "P7256", "P7422", "P7584", "P8011", "P1086", "P1087", "P1101", "P1109", "P1113", "P1342", "P1355", "P1436", "P1458", "P1470", "P1538", "P1603", "P1689", "P1697", "P2046", "P2047", "P2049", "P2101", "P2116", "P2120", "P2128", "P2139", "P2141", "P2196", "P2226", "P2230", "P2243", "P2260", "P2299", "P2320", "P2370", "P2407", "P2557", "P2630", "P2658", "P2806", "P2807", "P2835", "P2899", "P3041", "P3086", "P3260", "P3362", "P3559", "P3740", "P3864", "P3886", "P4103", "P4105", "P4183", "P4214", "P4268", "P4448", "P4815", "P4825", "P4876", "P4909", "P5022", "P5065", "P5427", "P5520", "P5893", "P6543", "P6547", "P6790", "P6801", "P7316", "P7443", "P7887", "P8049", "P8328", "P1106", "P1117", "P1129", "P1141", "P1373", "P1418", "P2066", "P2102", "P2130", "P2132", "P2137", "P2140", "P2151", "P2198", "P2215", "P2216", "P2222", "P2225", "P2240", "P2244", "P2297", "P2430", "P2528", "P2610", "P2645", "P2661", "P2662", "P2718", "P2790", "P2791", "P2907", "P2993", "P2998", "P2999", "P3020", "P3070", "P3078", "P3251", "P3270", "P3457", "P3485", "P3618", "P3629", "P4295", "P4296", "P4350", "P4403", "P4500", "P4714", "P4826", "P4912", "P5071", "P5141", "P5167", "P5436", "P5524", "P5593", "P5594", "P5595", "P5675", "P6075", "P6088", "P6257", "P6497", "P6879", "P7862", "P8010", "P8247"
    ));

    public static void main(String[] args) {
        args = "/GW/D5data-13/hvthinh/wikidata/wikidata-20200629-all-BETA.nt.gz /GW/D5data-13/hvthinh/wikidata/wikidata-20200629-numeric-facts.gz".split(" ");
        PrintWriter out = FileUtils.getPrintWriter(args[1], "UTF-8");
        SelfMonitor m = new SelfMonitor(ExtractNumericFacts.class.getName(), -1, 60);
        m.start();
        String prefix = "<http://www.wikidata.org/prop/";
        for (String line : FileUtils.getLineStream(args[0], "UTF-8")) {
            try {
                String arr[] = line.split(" ");
                if (arr[1].startsWith(prefix) && NUMERIC_PREDICATES.contains(arr[1].substring(prefix.length(), arr[1].length() - 1))) {
                    out.println(line);
                }
            } catch (Exception e) {
                System.err.println("err: " + line);
            }
            m.incAndGet();
        }
        m.forceShutdown();
        out.close();
    }
}
